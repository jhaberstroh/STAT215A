dsreturn$cluster <- sapply(dsreturn$cluster, as.character)
return dsreturn
ApplyHClust <- function(dataset, cluster.cols, tree.size){
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn$cluster <- NA
dsreturn$cluster <- clusters.tree
dsreturn$cluster <- sapply(dsreturn$cluster, as.character)
return dsreturn
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ApplyHClust <- function(dataset, cluster.cols, tree.size){
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn$cluster <- NA
dsreturn$cluster <- sapply(clusters.tree, as.character)
return dsreturn
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ApplyHClust <- function(dataset, cluster.cols, tree.size){
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn$cluster <- NA
dsreturn$cluster <- sapply(clusters.tree, as.character)
return dsreturn
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ApplyHClust <- function(dataset, cluster.cols, tree.size){
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn$cluster <- sapply(clusters.tree, as.character)
return dsreturn
ApplyHClust <- function(dataset, cluster.cols, tree.size){
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
ApplyHClust <- function(dataset, cluster.cols, tree.size){
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ApplyHClust <- function(dataset, cluster.cols, tree.size){
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
}
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
}
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- data.frame(dataset)
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
}
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- dataset
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- dataset
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- dataset
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return dsreturn
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dsreturn <- dataset
dsreturn[, 'cluster'] <- sapply(clusters.tree, as.character)
return(dsreturn)
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dataset[, 'cluster'] <- sapply(clusters.tree, as.character)
return(dataset)
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
View(spatial.nn.bin.copy)
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 7) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin <- GetNNSum(ling.data.bin, seq(-125,-115), seq(25,50), ling.ans)
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dataset[, 'cluster'] <- sapply(clusters.tree, as.character)
return(dataset)
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 7) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin) +
geom_point(aes(x=long,y=lat,color=Q050.4), shape=7) +
plot.map +
plot.blank
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 7) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin <- GetNNSum(ling.data.bin.train, seq(-125,-65), seq(25,50), ling.ans)
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
GetNNSum <- function(dataset, spatial, cols.pos, cols.sum, k=100){
# Create an empty dataset to populate
spatial.bin.merger <- data.frame(matrix(vector(), nrow(spatial),
length(cols.sum), dimnames=list(c(), cols.sum)),
stringsAsFactors=F)
spatial.nn.bin <- cbind(spatial[,c('long','lat')], spatial.bin.merger)
remove(spatial.bin.merger)
#ling.bin.ans <- names(dataset)[cols.sum]
spatial.nnlist <- nn2(dataset[,cols.pos],
spatial.nn.bin[,cols.pos], k=k)
for (i in 1:nrow(spatial)) {
spatial.nn.bin[i,cols.sum] <-
colSums(sapply(
ling.data.bin[spatial.nnlist$nn.idx[i,],cols.sum],as.numeric))
}
return(spatial.nn.bin)
}
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=tree.size)
dataset[, 'cluster'] <- sapply(clusters.tree, as.character)
return(dataset)
}
CreateGrid <- function(xseq, yseq){
spatial = data.frame(long=xseq)
spatial$all = 1
spatial.lat = data.frame(lat=yseq)
spatial.lat$all = 1
spatial <- inner_join(spatial, spatial.lat, by='all')
spatial <- spatial[,!names(spatial) %in% c('all')]
remove(spatial.lat)
return(spatial)
}
spatial.nn.bin <- GetNNSum(ling.data.bin.train,
CreateGrid(seq(-125,-65), seq(25,50)),
c('lat','long'), ling.ans)
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 7) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin <- GetNNSum(ling.data.bin.train,
CreateGrid(seq(-125,-65,.5), seq(25,50,.5)),
cols.pos=c('lat','long'), cols.sum=ling.ans)
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin, ling.ans, 8)
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 7) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin <- GetNNSum(ling.data.bin,
CreateGrid(seq(-125,-65), seq(25,50)),
cols.pos=c('lat','long'), cols.sum=ling.ans)
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=4)
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=6)
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=5)
# ----------------------------------------
# Plot the nn spatial map for cluster
# ----------------------------------------
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=4)
# ----------------------------------------
# Plot the nn spatial map for cluster
# ----------------------------------------
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=2)
# ----------------------------------------
# Plot the nn spatial map for cluster
# ----------------------------------------
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=3)
# ----------------------------------------
# Plot the nn spatial map for cluster
# ----------------------------------------
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=6)
# ----------------------------------------
# Plot the nn spatial map for cluster
# ----------------------------------------
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=7)
# ----------------------------------------
# Plot the nn spatial map for cluster
# ----------------------------------------
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
spatial.nn.bin <- GetNNSum(ling.data.bin,
CreateGrid(seq(-125,-65,.5), seq(25,50,.5)),
cols.pos=c('lat','long'), cols.sum=ling.ans)
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=7)
ApplyHClust <- function(dataset, cluster.cols, tree.size) {
clusters <- hclust(dist(dataset[,cluster.cols]))
clusters.tree <- cutree(clusters, k=2)
dataset[, 'cluster2'] <- sapply(clusters.tree, as.character)
clusters.tree <- cutree(clusters, k=3)
dataset[, 'cluster3'] <- sapply(clusters.tree, as.character)
clusters.tree <- cutree(clusters, k=4)
dataset[, 'cluster4'] <- sapply(clusters.tree, as.character)
clusters.tree <- cutree(clusters, k=5)
dataset[, 'cluster5'] <- sapply(clusters.tree, as.character)
clusters.tree <- cutree(clusters, k=6)
dataset[, 'cluster6'] <- sapply(clusters.tree, as.character)
clusters.tree <- cutree(clusters, k=7)
dataset[, 'cluster7'] <- sapply(clusters.tree, as.character)
clusters.tree <- cutree(clusters, k=8)
dataset[, 'cluster8'] <- sapply(clusters.tree, as.character)
return(dataset)
}
spatial.nn.bin.copy <- ApplyHClust(spatial.nn.bin,
cluster.cols=ling.ans,
tree.size=7)
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster3), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4) +
plot.map +
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster7), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster8), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster7), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.4) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.4) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.8) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.2) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
#geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.2) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.2) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster3), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=.2) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster3), shape=15, size = 4, alpha=.2) +
#  geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=.2) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.1) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.1) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4, alpha=.1) +
geom_point(aes(x=long,y=lat,color=cluster3), shape=15, size = 4, alpha=.1) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=.1) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.3) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4, alpha=.1) +
geom_point(aes(x=long,y=lat,color=cluster3), shape=15, size = 4, alpha=.1) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=.1) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster6), shape=15, size = 4, alpha=.6) +
geom_point(aes(x=long,y=lat,color=cluster5), shape=15, size = 4, alpha=.4) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4, alpha=.2) +
geom_point(aes(x=long,y=lat,color=cluster3), shape=15, size = 4, alpha=.1) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=.1) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=.1) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=1) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster2), shape=15, size = 4, alpha=.6) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
ggplot(spatial.nn.bin.copy) +
geom_point(aes(x=long,y=lat,color=cluster4), shape=15, size = 4, alpha=.6) +
plot.map +
plot.blank +
scale_color_brewer(palette = 'Set3')
save(spatial.nn.bin.copy, 'hclust_file.Rda')
save(spatial.nn.bin.copy, file='hclust_file.Rda')
ling.data.bin.pca <- prcomp(filter(spatial.nn.bin.copy, cluster2 == 1)[,ling.ans])
qplot(seq_along(ling.data.bin.pca$sdev), ling.data.bin.pca$sdev)
print(ncols(filter(spatial.nn.bin.copy,cluster2==1)))
ncol(filter(spatial.nn.bin.copy,cluster2==1))
ncol(filter(spatial.nn.bin.copy,cluster2==2))
ncol(filter(spatial.nn.bin.copy,cluster2==1))
ncol(filter(spatial.nn.bin.copy))
nrow(filter(spatial.nn.bin.copy,cluster2==1))
nrow(filter(spatial.nn.bin.copy,cluster2==2))
nrow(filter(spatial.nn.bin.copy,cluster2==1))
ling.data.bin.pca <- prcomp(filter(spatial.nn.bin.copy)[,ling.ans])
qplot(seq_along(ling.data.bin.pca$sdev), ling.data.bin.pca$sdev)
y_scale_log_10()
qplot(seq_along(ling.data.bin.pca$sdev), ling.data.bin.pca$sdev) +
y_scale_log_10()
qplot(seq_along(ling.data.bin.pca$sdev), ling.data.bin.pca$sdev) +
y_scale_log10()
qplot(seq_along(ling.data.bin.pca$sdev), ling.data.bin.pca$sdev) +
scale_y_log10()
ling.data.bin.pca <- prcomp(filter(spatial.nn.bin.copy, cluster2 == 1)[,ling.ans])
nn.pca.all <- prcomp(filter(spatial.nn.bin.copy)[,ling.ans])
nn.pca.c1.1 <- prcomp(filter(spatial.nn.bin.copy, cluster2 == 1)[,ling.ans])
qplot(seq_along(nn.pca.all$sdev), nn.pca.all$sdev) +
qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
qplot(seq_along(nn.pca.all$sdev), nn.pca.all$sdev) +
#  qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
qplot(seq_along(nn.pca.all$sdev), nn.pca.all$sdev) +
#qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
qplot(seq_along(nn.pca.all$sdev), nn.pca.all$sdev) +
#qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
qplot(seq_along(nn.pca.c1.1$sdev), nn.pca.c1.1$sdev) +
scale_y_log10()
colSums(nn.pca.c1.1$rotation)
rowSums(nn.pca.c1.1$rotation)
rot.squared <- mapply(nn.pca.c1.1, ^2)
rot.squared <- mapply(nn.pca.c1.1, square)
square(2)
squared(2)
2**2
rot.squared <- mapply(nn.pca.c1.1, **2)
rot.squared <- mapply(nn.pca.c1.1, '**2')
rot.squared <- mapply(nn.pca.c1.1, **2)
rot.squared <- nn.pca.c1.1**2
rot.squared <- nn.pca.c1.1.**2
rot.squared <- nn.pca.c1.1 * nn.pca.c1.1
rot.squared <- nn.pca.c1.1 * nn.pca.c1.1
nn.pca.c1.1 * nn.pca.c1.1
rot.squared <- nn.pca.c1.1$rot ** 2
colSums(nn.pca.c1.1$rotation)
rot.squared <- nn.pca.c1.1$rot ** 2
colSums(rot.squared)
